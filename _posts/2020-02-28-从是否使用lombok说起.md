---
layout: post
title: 从项目中是否应该使用lombok说起
categories: 三方库
description: 什么时候引入三方库
keywords: lombok
---


疫情期间在家刷新闻，头条推了一篇文章，大意是是新来的CTO禁止公司内部使用lombok；虽然做法偏激，但也有他的理由，至于是否认同就是仁者见仁智者见智了。

其实罗列lombok的好坏以及讨论是不是应该使用lombok网上有很多帖子了，但我觉得用和不用其实不仅仅因为出于那些列出优缺点就能一概而论的。先把网上关于lombok优缺点列一下：

**优点**：

* 能通过注解的形式自动生成构造器、getter/setter、equals、hashcode、toString等方法，提高了开发效率
* 让代码变得简洁，不用过多的去关注相应的方法
* 属性做修改时，也简化了维护为这些属性所生成的getter/setter方法等

**缺点**：

* 引入lombok包
* lombok本身会有一些坑，在使用中会有些许学习成本



从上家公司开始到目前公司的目前进行中的项目，基本上每个项目中都用了 lombok，做的项目主要偏业务类，涉及到金融保险APP以及汽车保养预约小程序等。本质上，我对 lombok 不反感，至于有人说的“项目中使用 lombok 就像QJ了项目成员”的看法，我会既同情又不以为然。

lombok不可否认有很多功能，但大家主要使用的原因可能还是它可以省去很多方法实现和定义的时间。所以争论的焦点很容易转到 lombok 能做的，IDE 也能快速自动生成 getter/setter 上。但我觉得，其实不仅仅是这样的。

程序员写代码首先追求的是效率高，功能强，稳定好吗？我觉得代码首要是追求代码的“可读性”，至少在解决业务问题的代码中是这样。

代码优秀的可读性可以保证代码容易被维护，容易被扩展，容易被理解，也容易被重构。意味着代码不是在一个“黑盒”中。效率高，功能强，稳定性好，但是一旦项目后续展开，任何业务修改，代码集体奔跑的时候就怕会散得七零八落了。相反，可读性好可以在一定程度上保证代码的开发效率，功能丰富以及稳定性上。

华为内部也越来越看重代码的可读性，甚至把它放在了第一位。而相对的，是Oracle的一个笑话，员工要改Oracle的Bug或者加新功能流程大抵是要理顺二十多个甚至数百个flag，然后通过测试集群跑一晚上甚至一整天去测试之前的修改，实在不行就再新加个flag… 

lombok省去的代码方法，不仅仅是省去写代码的功夫，更主要的是把源代码量变少，提高可读性。当用惯类似于lombok这类工具之后，当看到entity中大量无意义的getter/setter，会忍不住去看一遍是不是有些额外的逻辑在里面，这绝对不是可读性的好味道。

所以，如果是短期的业务为主的项目，我觉得推荐使用 lombok。但如果是一个基础设施项目，或者是一个时间跨度会是两三年乃至更久的项目，那么就应当避免引入三方库。

之前工作过一家SaaS平台，整个项目从1997年开始跨度将近有二十年，Web框架，ACL等等都是自研，服务将近有百万用户。项目组对于引入三方库就非常谨慎，他们更愿意对新兴技术和开源项目进行调研，然后“重复造轮子”。因为任何一个时兴的技术和三方库都不能保证可以一直有效运转下去，贸然引入然后很可能就成为项目体内的“肿瘤”而不可根除，我想这个平台是绝对不会欢迎引入lombok的。那些年因为引入外部依赖或者新技术而吞下的苦果其实并不少，比如引入yahoo的yui3（后来挂了），backbone等等。老外固守旧平台对于技术相对保守不是没有原因的。

其实lombok是这样，类似于Swagger又何尝不是如此。如果不是在充分吃透新技术之后再引入，难保不会面临开发流程上可能的转变带来的问题。虽然，这些“香饽饽”对于一两年或者更短周期的项目是不可多得的利器。
