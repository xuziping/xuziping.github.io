---
layout: post
title: 从项目中是否应该使用lombok说起
categories: 三方库
description: 什么时候引入三方库
keywords: lombok 产品 项目 三方库
---


疫情期间在家刷新闻，头条推了篇“吐糟”，大意是是新来的CTO禁止公司内部使用lombok，巴拉巴拉... 虽然做法偏激，但其实也有他的理由，至于是不是认同那就是仁者见仁智者见智了。

其实罗列lombok的优缺点以及讨论项目中要不要用在网上已经有很多帖子了，但我觉得最终怎么选不应只局限它本身的优缺点上。先把网上关于lombok优缺点列一下：

> **优点**：
> 
> * 能通过注解的形式自动生成构造器、getter/setter、equals、hashcode、toString等方法，提高了开发效率
> * 让代码变得简洁，不用过多的去关注相应的方法
> * 属性做修改时，也简化了维护为这些属性所生成的getter/setter方法等

> **缺点**：
> 
> * 引入lombok包
> * lombok本身会有一些坑，在使用中会有些许学习成本


我从上家公司到目前公司进行的项目里（项目主要偏业务类，涉及到金融保险APP以及汽车保养预约小程序等），基本上所有项目中都引入了lombok。本质上，我对lombok不反感，至于有人说的“_项目中使用 lombok就像QJ了项目成员_”，我会既同情又不以为然。

lombok不可否认有很多功能，但大家主要使用的原因可能还是它可以省去很多方法实现和定义的时间，所以争论的焦点很容易转到lombok能做的IDE也能快速自动生成 getter/setter方法上。但我觉得，其实不仅仅是这样的。

程序员写代码首先追求的是效率高，功能强，稳定好吗？**我觉得代码首要是追求代码的“可读性”，至少在解决业务问题的代码中是这样。**

代码优秀的可读性可以保证代码容易被维护，容易被扩展，容易被理解，也容易被重构——意味着代码不是在一个“黑盒”中。效率高，功能强，稳定性好，但是一旦项目后续展开，任何业务上的变动，代码一起裸奔的时候就怕会散得七零八落惨不忍睹了；反之，可读性好可以很大程度上保证开发效率，功能丰富以及代码质量。

听说华为内部也越来越看重代码的可读性，有部门甚至拉横幅把它摆在了第一位；而相对的是Oracle的一个笑话，员工要改Oracle的Bug或者加新功能是通过加各种晦涩的标志位，然后通过测试集群跑一晚上甚至一整天去测试之前的修改，实在不行就再新加个标志位...… 

lombok省去的代码方法，不仅仅是省去写代码的功夫，**更主要的是把源代码量变少，很大程度提高可读性，保证代码的美观。**当用惯类似于lombok这类工具后，再看到entity中大量无意义的getter/setter，会忍不住去检查是不是这些方法里有额外的业务逻辑，这绝不是有“好味道”的代码。

如果你以为我要力推类lombok的“效率三方库”了，那却也不尽然。之前工作过一家SaaS教育平台，整个网站从1997年开始跨度将近有二十年，Web框架，acl等都是自研，服务将近有百万用户。**公司对于引入三方库就非常谨慎，他们更愿意对新兴技术和开源项目进行调研，然后“重复造轮子”，从而保证代码的掌控**。那时有点不以为然，现在却觉得他们“保守”的做法是正确的。

因为**任何一个时兴的技术和三方库都不能保证可以一直有效运转下去，贸然引入然后很可能就成为项目体内的“肿瘤”而不可根除**，我想这个平台是绝对不会欢迎引入lombok这类第三方效率工具的。这家公司因为引入外部依赖或者新技术而吞下的苦并不少，比如引入yahoo的yui3（后来挂了），backbone（被淘汰）等等。老外固守旧平台对于技术相对保守不是没有原因的。

其实lombok是这样，类似于Swagger又何尝不是如此。如果不是在充分吃透新技术之后再引入，难保不会面临开发流程上可能的转变所带来的问题。可能国内项目比较急功近利，都喜欢用新的酷炫的概念和技术，但忽视了大部分新技术最终会沦为炮灰的事实。虽然，一些“香饽饽”对于一两年或者更短周期的项目是不可多得的利器，但长远看其实是不符合客户利益的，这也是给自己人日后挖坑（当然，这也可能是国内项目前人给后人制造“商机”的一个手段）。

综上，如果是短期的业务为主的项目，我觉得推荐使用三方库提高效率；但如果是一个基础设施项目，或者是一个时间跨度会是两三年乃至更久的项目，那么就应当非常谨慎引入三方库。无奈的是目前市场就是大家都以做项毕业设计的心态做项目，虽然对个人可能是成长，可对于客户和产品本身其实是非常不利的... **谁说软件不是在设计之初就已各有天命了呢**？